query CalloutContributions(
  $calloutId: UUID!
  $includeLink: Boolean! = false
  $includeWhiteboard: Boolean! = false
  $includeMemo: Boolean! = false
  $includePost: Boolean! = false
  $filter: [CalloutContributionType!] = [LINK, WHITEBOARD, MEMO, POST]
  $limit: Int
) {
  lookup {
    callout(ID: $calloutId) {
      id
      contributions(filter: { types: $filter }, limit: $limit) {
        id
        sortOrder
        link @include(if: $includeLink) {
          ...LinkDetailsWithAuthorization
        }
        whiteboard @include(if: $includeWhiteboard) {
          ...CalloutContributionsWhiteboardCard
        }
        memo @include(if: $includeMemo) {
          ...CalloutContributionsMemoCard
        }
        post @include(if: $includePost) {
          ...CalloutContributionsPostCard
        }
      }
      contributionsCount {
        link @include(if: $includeLink)
        whiteboard @include(if: $includeWhiteboard)
        memo @include(if: $includeMemo)
        post @include(if: $includePost)
      }
    }
  }
}

fragment CalloutContributionsWhiteboardCard on Whiteboard {
  id
  profile {
    id
    url
    displayName
    visual(type: CARD) {
      ...VisualModel
    }
  }
  authorization {
    id
    myPrivileges
  }
  createdDate
  createdBy {
    ...ContributionAuthor
  }
}

fragment CalloutContributionsMemoCard on Memo {
  id
  profile {
    id
    url
    displayName
  }
  markdown
  createdDate
  createdBy {
    ...ContributionAuthor
  }
}

fragment CalloutContributionsPostCard on Post {
  id
  profile {
    id
    url
    displayName
    tagset {
      ...TagsetDetails
    }
    description
  }
  createdDate
  createdBy {
    ...ContributionAuthor
  }
  authorization {
    id
    myPrivileges
  }
  comments {
    id
    messagesCount
  }
}

fragment ContributionAuthor on User {
  id
  profile {
    id
    displayName
    avatar: visual(type: AVATAR) {
      id
      name
      uri
    }
  }
}